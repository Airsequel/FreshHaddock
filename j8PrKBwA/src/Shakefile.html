<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Shakefile</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-2"></a><span>
</span><a name="line-3"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Function</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&amp;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-4"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Development</span><span class="hs-operator">.</span><span class="hs-identifier">Shake</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- import Development.Shake.Command</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Development</span><span class="hs-operator">.</span><span class="hs-identifier">Shake</span><span class="hs-operator">.</span><span class="hs-identifier">FilePath</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- import Development.Shake.Util</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-identifier">customShakeOptions</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">ShakeOptions</span><span>
</span><a name="line-11"></a><a name="customShakeOptions"><a href="Shakefile.html#customShakeOptions"><span class="hs-identifier">customShakeOptions</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">shakeOptions</span><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">shakeColor</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-comment">-- Print colors to terminal</span><span>
</span><a name="line-13"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shakeThreads</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span>  </span><span class="hs-comment">-- Match number of processors</span><span>
</span><a name="line-14"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shakeTimings</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>  </span><span class="hs-comment">-- Print runtime statistics</span><span>
</span><a name="line-15"></a><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">shakeFiles</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;shakecache&quot;</span><span> </span><span class="hs-comment">-- Save cache files to `shakecache`</span><span>
</span><a name="line-16"></a><span>  </span><span class="hs-comment">-- Enable following line if you need to check out the report</span><span>
</span><a name="line-17"></a><span>  </span><span class="hs-comment">-- , shakeReport = [&quot;shake-report.html&quot;] -- Enable this</span><span>
</span><a name="line-18"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-identifier">main</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-22"></a><a name="main"><a href="Shakefile.html#main"><span class="hs-identifier">main</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">shakeArgs</span><span> </span><a href="Shakefile.html#customShakeOptions"><span class="hs-identifier hs-var">customShakeOptions</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span>  </span><span class="hs-comment">-- Use index.html file as proxy for all other targets</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-identifier hs-var">want</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;build/index.html&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-26"></a><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-comment">-- Build main HTML file (and all other targets)</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-string">&quot;build/index.html&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130398"><a href="#local-6989586621679130398"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>    </span><a name="local-6989586621679130399"><a href="#local-6989586621679130399"><span class="hs-identifier">redirects</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/redirects/*.pug&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-32"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130400"><a href="#local-6989586621679130400"><span class="hs-identifier">redirectTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130399"><span class="hs-identifier hs-var">redirects</span></a><span>
</span><a name="line-33"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropExtension</span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679130401"><a href="#local-6989586621679130401"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130401"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;/index.html&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>    </span><a name="local-6989586621679130402"><a href="#local-6989586621679130402"><span class="hs-identifier">svgFiles</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/images//*.svg&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-37"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130403"><a href="#local-6989586621679130403"><span class="hs-identifier">svgTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130402"><span class="hs-identifier hs-var">svgFiles</span></a><span>
</span><a name="line-38"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">dropDirectory1</span><span>
</span><a name="line-39"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span>    </span><a name="local-6989586621679130404"><a href="#local-6989586621679130404"><span class="hs-identifier">pngFiles</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/images//*.png&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130405"><a href="#local-6989586621679130405"><span class="hs-identifier">pngTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130404"><span class="hs-identifier hs-var">pngFiles</span></a><span>
</span><a name="line-43"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">dropDirectory1</span><span>
</span><a name="line-44"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span>    </span><a name="local-6989586621679130406"><a href="#local-6989586621679130406"><span class="hs-identifier">contactFiles</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/contacts//*.vcf&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130407"><a href="#local-6989586621679130407"><span class="hs-identifier">contactTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679130406"><span class="hs-identifier hs-var">contactFiles</span></a><span>
</span><a name="line-48"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">dropDirectory1</span><span>
</span><a name="line-49"></a><span>          </span><span class="hs-operator hs-var">&amp;</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>    </span><span class="hs-keyword">let</span><span>
</span><a name="line-52"></a><span>      </span><a name="local-6989586621679130408"><a href="#local-6989586621679130408"><span class="hs-identifier">subPages</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679130412"><a href="#local-6989586621679130412"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130412"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;/index.html&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-53"></a><span>        </span><span class="hs-string">&quot;about&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-54"></a><span>        </span><span class="hs-comment">-- &quot;blog&quot; :</span><span>
</span><a name="line-55"></a><span>        </span><span class="hs-comment">-- TODO: Reenable after fixing buildModules.js</span><span>
</span><a name="line-56"></a><span>        </span><span class="hs-string">&quot;features&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-57"></a><span>        </span><span class="hs-string">&quot;help&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-58"></a><span>        </span><span class="hs-string">&quot;help/getting-started-bitbucket&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-59"></a><span>        </span><span class="hs-string">&quot;help/getting-started-github&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-60"></a><span>        </span><span class="hs-string">&quot;help/getting-started&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-61"></a><span>        </span><span class="hs-string">&quot;imprint&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-62"></a><span>        </span><span class="hs-comment">-- &quot;login&quot; :</span><span>
</span><a name="line-63"></a><span>        </span><span class="hs-string">&quot;pricing&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-64"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><span>      </span><a name="local-6989586621679130409"><a href="#local-6989586621679130409"><span class="hs-identifier">miscTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;build/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-66"></a><span>        </span><span class="hs-string">&quot;CNAME&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-67"></a><span>        </span><span class="hs-string">&quot;images/favicon.png&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-68"></a><span>        </span><span class="hs-string">&quot;robots.txt&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-69"></a><span>        </span><span class="hs-string">&quot;scripts/main.js&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-70"></a><span>        </span><span class="hs-string">&quot;sitemap.xml&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-71"></a><span>        </span><span class="hs-string">&quot;styles/screen.css&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-72"></a><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>      </span><a name="local-6989586621679130410"><a href="#local-6989586621679130410"><span class="hs-identifier">allTargets</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-74"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130400"><span class="hs-identifier hs-var">redirectTargets</span></a><span>
</span><a name="line-75"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130403"><span class="hs-identifier hs-var">svgTargets</span></a><span>
</span><a name="line-76"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130405"><span class="hs-identifier hs-var">pngTargets</span></a><span>
</span><a name="line-77"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130407"><span class="hs-identifier hs-var">contactTargets</span></a><span>
</span><a name="line-78"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130408"><span class="hs-identifier hs-var">subPages</span></a><span>
</span><a name="line-79"></a><span>        </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679130409"><span class="hs-identifier hs-var">miscTargets</span></a><span>
</span><a name="line-80"></a><span>      </span><a name="local-6989586621679130411"><a href="#local-6989586621679130411"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><a href="#local-6989586621679130398"><span class="hs-identifier hs-var">out</span></a><span> </span><span class="hs-operator hs-var">-&lt;.&gt;</span><span> </span><span class="hs-string">&quot;pug&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-83"></a><span>      </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-var">source</span></a><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-84"></a><span>      </span><span class="hs-string">&quot;source/partials/layout.pug&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-85"></a><span>      </span><span class="hs-string">&quot;node_modules/.bin/pug&quot;</span><span> </span><span class="hs-glyph">:</span><span>
</span><a name="line-86"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><a href="#local-6989586621679130410"><span class="hs-identifier hs-var">allTargets</span></a><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span>
</span><a name="line-91"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdin</span><span> </span><a href="#local-6989586621679130411"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdout</span><span> </span><a href="#local-6989586621679130398"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>      </span><span class="hs-string">&quot;yarn --silent pug&quot;</span><span>
</span><a name="line-94"></a><span>      </span><span class="hs-string">&quot;--path&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130411"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span>  </span><span class="hs-comment">-- Build sub-pages</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-special">[</span><span class="hs-string">&quot;build/*/index.html&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;build/help/*/index.html&quot;</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">|%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130413"><a href="#local-6989586621679130413"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130414"><a href="#local-6989586621679130414"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">takeDirectory</span><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;.pug&quot;</span><span>
</span><a name="line-100"></a><span>
</span><a name="line-101"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130414"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;source/partials/layout.pug&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;node_modules/.bin/pug&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span>
</span><a name="line-104"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdin</span><span> </span><a href="#local-6989586621679130414"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">)</span><span>
</span><a name="line-105"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdout</span><span> </span><a href="#local-6989586621679130413"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>      </span><span class="hs-string">&quot;yarn --silent pug&quot;</span><span>
</span><a name="line-107"></a><span>      </span><span class="hs-string">&quot;--path&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130414"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-string">&quot;build/features/index.html&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130415"><a href="#local-6989586621679130415"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130416"><a href="#local-6989586621679130416"><span class="hs-identifier">script</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;helpers/buildModules.js&quot;</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier hs-var">need</span><span>
</span><a name="line-113"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;source/features.pug&quot;</span><span>
</span><a name="line-114"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;source/partials/layout.pug&quot;</span><span>
</span><a name="line-115"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679130416"><span class="hs-identifier hs-var">script</span></a><span>
</span><a name="line-116"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdout</span><span> </span><a href="#local-6989586621679130415"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;node&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130416"><span class="hs-identifier hs-var">script</span></a><span class="hs-special">]</span><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-string">&quot;build/help/index.html&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130417"><a href="#local-6989586621679130417"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130418"><a href="#local-6989586621679130418"><span class="hs-identifier">script</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;helpers/buildFaq.js&quot;</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-identifier hs-var">need</span><span>
</span><a name="line-123"></a><span>      </span><span class="hs-special">[</span><span> </span><span class="hs-string">&quot;source/data/questions-and-answers.yaml&quot;</span><span>
</span><a name="line-124"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;source/help.pug&quot;</span><span>
</span><a name="line-125"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;source/partials/layout.pug&quot;</span><span>
</span><a name="line-126"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679130418"><span class="hs-identifier hs-var">script</span></a><span>
</span><a name="line-127"></a><span>      </span><span class="hs-special">]</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdout</span><span> </span><a href="#local-6989586621679130417"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span> </span><span class="hs-string">&quot;node&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130418"><span class="hs-identifier hs-var">script</span></a><span class="hs-special">]</span><span>
</span><a name="line-129"></a><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span>  </span><span class="hs-comment">-- Build main CSS file</span><span>
</span><a name="line-132"></a><span>  </span><span class="hs-string">&quot;build/styles/screen.css&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130419"><a href="#local-6989586621679130419"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130420"><a href="#local-6989586621679130420"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><a href="#local-6989586621679130419"><span class="hs-identifier hs-var">out</span></a><span> </span><span class="hs-operator hs-var">-&lt;.&gt;</span><span> </span><span class="hs-string">&quot;styl&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>    </span><a name="local-6989586621679130421"><a href="#local-6989586621679130421"><span class="hs-identifier">styleSheets</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/styles/*.styl&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><a href="#local-6989586621679130421"><span class="hs-identifier hs-var">styleSheets</span></a><span>
</span><a name="line-136"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span>
</span><a name="line-137"></a><span>      </span><span class="hs-string">&quot;yarn --silent stylus&quot;</span><span>
</span><a name="line-138"></a><span>      </span><span class="hs-string">&quot;--compress&quot;</span><span>
</span><a name="line-139"></a><span>      </span><span class="hs-string">&quot;--out&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130419"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">]</span><span>
</span><a name="line-140"></a><span>      </span><span class="hs-special">[</span><a href="#local-6989586621679130420"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>  </span><span class="hs-comment">-- Build main JavaScript file</span><span>
</span><a name="line-144"></a><span>  </span><span class="hs-string">&quot;build/scripts/main.js&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130422"><a href="#local-6989586621679130422"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-145"></a><span>    </span><a name="local-6989586621679130423"><a href="#local-6989586621679130423"><span class="hs-identifier">scripts</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">getDirectoryFiles</span><span> </span><span class="hs-string">&quot;&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;source/scripts/*.js&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><a href="#local-6989586621679130423"><span class="hs-identifier hs-var">scripts</span></a><span>
</span><a name="line-147"></a><span>    </span><span class="hs-identifier hs-var">Stdout</span><span> </span><a name="local-6989586621679130424"><a href="#local-6989586621679130424"><span class="hs-identifier">combined</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">cmd</span><span> </span><span class="hs-string">&quot;cat&quot;</span><span> </span><a href="#local-6989586621679130423"><span class="hs-identifier hs-var">scripts</span></a><span>
</span><a name="line-148"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Stdin</span><span> </span><a href="#local-6989586621679130424"><span class="hs-identifier hs-var">combined</span></a><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>      </span><span class="hs-string">&quot;yarn&quot;</span><span>
</span><a name="line-150"></a><span>      </span><span class="hs-string">&quot;--silent minify&quot;</span><span>
</span><a name="line-151"></a><span>      </span><span class="hs-string">&quot;--mangle&quot;</span><span>
</span><a name="line-152"></a><span>      </span><span class="hs-string">&quot;--out-file&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130422"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">]</span><span>
</span><a name="line-153"></a><span>
</span><a name="line-154"></a><span>
</span><a name="line-155"></a><span>  </span><span class="hs-comment">-- Build redirection pages</span><span>
</span><a name="line-156"></a><span>  </span><span class="hs-string">&quot;build/redirects/*/index.html&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130425"><a href="#local-6989586621679130425"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130426"><a href="#local-6989586621679130426"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">takeDirectory</span><span> </span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;.pug&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier hs-var">putNormal</span><span> </span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">source</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-identifier hs-var">putNormal</span><span> </span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span>    </span><span class="hs-identifier hs-var">cmd</span><span>
</span><a name="line-165"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdin</span><span> </span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">)</span><span>
</span><a name="line-166"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">FileStdout</span><span> </span><a href="#local-6989586621679130425"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-167"></a><span>      </span><span class="hs-string">&quot;yarn --silent pug&quot;</span><span>
</span><a name="line-168"></a><span>      </span><span class="hs-string">&quot;--path&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130426"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-comment">-- Build SVG images</span><span>
</span><a name="line-172"></a><span>  </span><span class="hs-string">&quot;build/images//*.svg&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130427"><a href="#local-6989586621679130427"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130428"><a href="#local-6989586621679130428"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><a href="#local-6989586621679130427"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130428"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span>
</span><a name="line-176"></a><span>      </span><span class="hs-string">&quot;yarn --silent&quot;</span><span>
</span><a name="line-177"></a><span>      </span><span class="hs-string">&quot;svgo&quot;</span><span>
</span><a name="line-178"></a><span>      </span><span class="hs-string">&quot;--input&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130428"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-179"></a><span>      </span><span class="hs-string">&quot;--output&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130427"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">]</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span>
</span><a name="line-182"></a><span>  </span><span class="hs-comment">-- Build PNG images</span><span>
</span><a name="line-183"></a><span>  </span><span class="hs-string">&quot;build/images//*.png&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130429"><a href="#local-6989586621679130429"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-184"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130430"><a href="#local-6989586621679130430"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><a href="#local-6989586621679130429"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-185"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130430"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span>
</span><a name="line-187"></a><span>      </span><span class="hs-string">&quot;optipng&quot;</span><span>
</span><a name="line-188"></a><span>      </span><span class="hs-string">&quot;-backup&quot;</span><span>
</span><a name="line-189"></a><span>      </span><span class="hs-string">&quot;-strip all&quot;</span><span>
</span><a name="line-190"></a><span>      </span><span class="hs-string">&quot;-out&quot;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130429"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">]</span><span>
</span><a name="line-191"></a><span>      </span><span class="hs-special">[</span><a href="#local-6989586621679130430"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span>
</span><a name="line-194"></a><span>  </span><span class="hs-keyword">let</span><span>
</span><a name="line-195"></a><span>    </span><a name="local-6989586621679130431"><a href="#local-6989586621679130431"><span class="hs-identifier">chokidarBinary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;node_modules/.bin/chokidar&quot;</span><span>
</span><a name="line-196"></a><span>    </span><a name="local-6989586621679130432"><a href="#local-6989586621679130432"><span class="hs-identifier">faviconPath</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;node_modules/@feram/design/pngs/favicon.png&quot;</span><span>
</span><a name="line-197"></a><span>    </span><a name="local-6989586621679130433"><a href="#local-6989586621679130433"><span class="hs-identifier">liveServerBinary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;node_modules/.bin/live-server&quot;</span><span>
</span><a name="line-198"></a><span>    </span><a name="local-6989586621679130434"><a href="#local-6989586621679130434"><span class="hs-identifier">pugBinary</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;node_modules/.bin/pug&quot;</span><span>
</span><a name="line-199"></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span>  </span><span class="hs-string">&quot;build/images/favicon.png&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130435"><a href="#local-6989586621679130435"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-202"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130432"><span class="hs-identifier hs-var">faviconPath</span></a><span class="hs-special">]</span><span>
</span><a name="line-203"></a><span>    </span><span class="hs-identifier hs-var">copyFileChanged</span><span> </span><a href="#local-6989586621679130432"><span class="hs-identifier hs-var">faviconPath</span></a><span> </span><a href="#local-6989586621679130435"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-comment">-- Build contact files</span><span>
</span><a name="line-207"></a><span>  </span><span class="hs-string">&quot;build/contacts//*.vcf&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130436"><a href="#local-6989586621679130436"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-208"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130437"><a href="#local-6989586621679130437"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;source/&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">dropDirectory1</span><span> </span><a href="#local-6989586621679130436"><span class="hs-identifier hs-var">out</span></a><span class="hs-special">)</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130437"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier hs-var">copyFileChanged</span><span> </span><a href="#local-6989586621679130437"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679130436"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-211"></a><span>
</span><a name="line-212"></a><span>
</span><a name="line-213"></a><span>  </span><span class="hs-comment">-- Build CNAME file for redirecton of custom domain to GitHub pages</span><span>
</span><a name="line-214"></a><span>  </span><span class="hs-string">&quot;build/CNAME&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130438"><a href="#local-6989586621679130438"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-215"></a><span>    </span><span class="hs-identifier hs-var">writeFileChanged</span><span> </span><a href="#local-6989586621679130438"><span class="hs-identifier hs-var">out</span></a><span> </span><span class="hs-string">&quot;www.feram.io\n&quot;</span><span>
</span><a name="line-216"></a><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span>  </span><span class="hs-comment">-- Install all node dependencies</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-special">[</span><a href="#local-6989586621679130432"><span class="hs-identifier hs-var">faviconPath</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679130433"><span class="hs-identifier hs-var">liveServerBinary</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679130434"><span class="hs-identifier hs-var">pugBinary</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679130431"><span class="hs-identifier hs-var">chokidarBinary</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">|%&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-220"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;yarn.lock&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-221"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span>
</span><a name="line-222"></a><span>      </span><span class="hs-string">&quot;yarn install&quot;</span><span>
</span><a name="line-223"></a><span>      </span><span class="hs-string">&quot;--pure-lockfile&quot;</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span>
</span><a name="line-226"></a><span>  </span><span class="hs-string">&quot;yarn.lock&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-227"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;package.json&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-228"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span> </span><span class="hs-string">&quot;yarn install&quot;</span><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span>
</span><a name="line-231"></a><span>  </span><span class="hs-comment">-- Add robots.txt file to website</span><span>
</span><a name="line-232"></a><span>  </span><span class="hs-string">&quot;build/robots.txt&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130439"><a href="#local-6989586621679130439"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-233"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130440"><a href="#local-6989586621679130440"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;robots.txt&quot;</span><span>
</span><a name="line-234"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130440"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-235"></a><span>    </span><span class="hs-identifier hs-var">copyFileChanged</span><span> </span><a href="#local-6989586621679130440"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679130439"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-236"></a><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span>  </span><span class="hs-comment">-- TODO: Automatically generate sitemap</span><span>
</span><a name="line-239"></a><span>  </span><span class="hs-comment">-- Add sitemap.xml file to website</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-string">&quot;build/sitemap.xml&quot;</span><span> </span><span class="hs-operator hs-var">%&gt;</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679130441"><a href="#local-6989586621679130441"><span class="hs-identifier">out</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-241"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679130442"><a href="#local-6989586621679130442"><span class="hs-identifier">source</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;sitemap.xml&quot;</span><span>
</span><a name="line-242"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130442"><span class="hs-identifier hs-var">source</span></a><span class="hs-special">]</span><span>
</span><a name="line-243"></a><span>    </span><span class="hs-identifier hs-var">copyFileChanged</span><span> </span><a href="#local-6989586621679130442"><span class="hs-identifier hs-var">source</span></a><span> </span><a href="#local-6989586621679130441"><span class="hs-identifier hs-var">out</span></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span>  </span><span class="hs-comment">-- TODO: Fix .shake.lock problems</span><span>
</span><a name="line-247"></a><span>  </span><span class="hs-comment">-- Use chokidar for continuous rebuilding</span><span>
</span><a name="line-248"></a><span>  </span><span class="hs-identifier hs-var">phony</span><span> </span><span class="hs-string">&quot;watch&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-249"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130431"><span class="hs-identifier hs-var">chokidarBinary</span></a><span class="hs-special">]</span><span>
</span><a name="line-250"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span>
</span><a name="line-251"></a><span>      </span><span class="hs-string">&quot;yarn chokidar&quot;</span><span>
</span><a name="line-252"></a><span>      </span><span class="hs-string">&quot;source helpers&quot;</span><span>
</span><a name="line-253"></a><span>      </span><span class="hs-string">&quot;--initial&quot;</span><span>
</span><a name="line-254"></a><span>      </span><span class="hs-string">&quot;--polling&quot;</span><span>
</span><a name="line-255"></a><span>      </span><span class="hs-string">&quot;--command&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;stack runghc ./Shakefile.hs&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span>
</span><a name="line-258"></a><span>  </span><span class="hs-comment">-- Serve build directory with live-server</span><span>
</span><a name="line-259"></a><span>  </span><span class="hs-identifier hs-var">phony</span><span> </span><span class="hs-string">&quot;serve&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-260"></a><span>    </span><span class="hs-identifier hs-var">need</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679130433"><span class="hs-identifier hs-var">liveServerBinary</span></a><span class="hs-special">]</span><span>
</span><a name="line-261"></a><span>    </span><span class="hs-identifier hs-var">cmd_</span><span> </span><span class="hs-string">&quot;yarn live-server build&quot;</span><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span>  </span><span class="hs-comment">-- Remove all build artifacts and dependencies</span><span>
</span><a name="line-265"></a><span>  </span><span class="hs-identifier hs-var">phony</span><span> </span><span class="hs-string">&quot;clean&quot;</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-266"></a><span>    </span><span class="hs-identifier hs-var">removeFilesAfter</span><span> </span><span class="hs-string">&quot;build&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;//*&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-267"></a><span>    </span><span class="hs-identifier hs-var">removeFilesAfter</span><span> </span><span class="hs-string">&quot;node_modules&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;//*&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-268"></a><span>    </span><span class="hs-identifier hs-var">removeFilesAfter</span><span> </span><span class="hs-string">&quot;shakecache&quot;</span><span> </span><span class="hs-special">[</span><span class="hs-string">&quot;//*&quot;</span><span class="hs-special">]</span><span>
</span><a name="line-269"></a></pre></body></html>